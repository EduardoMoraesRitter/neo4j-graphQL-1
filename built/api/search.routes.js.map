{"version":3,"sources":["../../app/api/search.routes.js"],"names":[],"mappings":";;AAAA,OAAO,OAAP,GAAiB,UAAS,MAAT,EAAgB,MAAhB,EAAuB;;AAEpC,iBAFoC;;AAKpC,QAAI,SAAS,QAAQ,UAAR,EAAoB,MAApB,CAAT;;;AALgC,UAQlC,CAAO,KAAP,CAAa,SAAb,EAAwB,IAAxB,CAA6B,UAAS,GAAT,EAAa,GAAb,EAAiB;AAC5C,YAAI,MAAM,IAAI,IAAJ,CAAS,GAAT,CADkC;AAE5C,YAAI,WAAW,IAAI,IAAJ,CAAS,QAAT,CAF6B;;AAI5C,YAAI,QAAJ,CAJ4C;;AAM5C,YAAI,CAAC,QAAD,EAAU;AACV,uBAAW,OAAO,GAAP,CADD;SAAd,MAGK,IAAI,aAAa,MAAb,EACT;AACI,uBAAW,oBAAU;AACjB,uBAAO,OAAO,KAAP,CAAa,MAAb,EAAoB,GAApB,CAAP,CADiB;aAAV,CADf;SADK,MAMA,IAAI,aAAa,OAAb,EACT;AACI,uBAAW,oBAAU;AACjB,uBAAO,OAAO,KAAP,CAAa,OAAb,EAAqB,GAArB,CAAP,CADiB;aAAV,CADf;SADK,MAMD;AACA,gBAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,sCAAsC,QAAtC,CAArB,CADA;SANC;;AAUL,iBAAS,GAAT,EACK,IADL,CACU,UAAU,IAAV,EAAgB;AAClB,gBAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,IAArB,EADkB;SAAhB,CADV,CAIK,KAJL,CAIW,UAAU,GAAV,EAAe;AAClB,gBAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,GAArB,EADkB;SAAf,CAJX,CAzB4C;KAAjB,CAA7B,CARkC;;AA2CpC,WAAO,KAAP,CAAa,qBAAb,EAAoC,GAApC,CAAwC,UAAS,GAAT,EAAa,GAAb,EAAiB;AACrD,eAAO,KAAP,CAAa,IAAI,MAAJ,CAAW,KAAX,EAAiB,IAAI,MAAJ,CAAW,GAAX,CAA9B,CAA8C,IAA9C,CAAmD,UAAU,IAAV,EAAgB;AAC3D,gBAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,IAArB,EAD2D;SAAhB,CAAnD,CAGK,KAHL,CAGW,UAAU,GAAV,EAAe;AAClB,gBAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,GAArB,EADkB;SAAf,CAHX,CADqD;KAAjB,CAAxC;;;AA3CoC,UAqDhC,CAAO,KAAP,CAAa,cAAb,EAA6B,GAA7B,CAAiC,UAAS,GAAT,EAAa,GAAb,EAAiB;AAClD,eAAO,KAAP,CAAa,OAAb,EAAqB,IAAI,MAAJ,CAAW,GAAX,CAArB,CAAqC,IAArC,CAA0C,UAAU,IAAV,EAAgB;AACnD,gBAAI,CAAC,IAAD,EAAM;AACL,oBAAI,UAAJ,CAAe,GAAf,EADK;aAAV,MAGK;AACA,oBAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,IAArB,EADA;aAHL;SADmC,CAA1C,CAQK,KARL,CAQW,UAAU,GAAV,EAAe;AAClB,gBAAI,MAAJ,CAAW,GAAX,EAAgB,IAAhB,CAAqB,GAArB,EADkB;SAAf,CARX,CADkD;KAAjB,CAAjC,CArDgC;;AA0EpC,WAAO,MAAP,CA1EoC;CAAvB","file":"search.routes.js","sourcesContent":["module.exports = function(config,router){\r\n    \r\n    \"use strict\";\r\n\r\n \r\n    var search = require('./search')(config);\r\n\r\n    //used to be /node/match\r\n      router.route('/search').post(function(req,res){\r\n        var txt = req.body.txt;\r\n        var restrict = req.body.restrict;\r\n        \r\n        var searchFn;\r\n        \r\n        if (!restrict){\r\n            searchFn = search.all;\r\n        }\r\n        else if (restrict === \"user\")\r\n        {\r\n            searchFn = function(){\r\n                return search.label(\"User\",txt);\r\n            };\r\n        }\r\n        else if (restrict === \"label\")\r\n        {\r\n            searchFn = function(){\r\n                return search.label(\"Label\",txt);\r\n            };\r\n        }\r\n        else{\r\n            res.status(501).json(\"Restrict option not implemented: \" + restrict);\r\n        }\r\n\r\n        searchFn(txt)\r\n            .then(function (data) {\r\n                res.status(200).json(data);\r\n            })\r\n            .catch(function (err) {\r\n                res.status(500).json(err);\r\n            });\r\n    });\r\n    \r\n    \r\n    router.route('/search/:label/:txt').get(function(req,res){\r\n        search.label(req.params.label,req.params.txt).then(function (data) {\r\n                res.status(200).json(data);\r\n            })\r\n            .catch(function (err) {\r\n                res.status(500).json(err);\r\n            });\r\n    });\r\n    \r\n    //default search is anything with the Label label\r\n        router.route('/search/:txt').get(function(req,res){\r\n        search.label(\"Label\",req.params.txt).then(function (data) {\r\n               if (!data){\r\n                    res.sendStatus(204);\r\n                }\r\n                else{\r\n                    res.status(200).json(data);\r\n                }\r\n            })\r\n            .catch(function (err) {\r\n                res.status(500).json(err);\r\n            });\r\n    });\r\n     \r\n  \r\n    \r\n\r\n\r\n  \r\n  \r\n\r\n    return router;\r\n\r\n};\r\n"]}