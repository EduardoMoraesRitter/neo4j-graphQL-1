{"version":3,"sources":["../../src/api/predicate.js"],"names":[],"mappings":"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","file":"predicate.js","sourcesContent":["module.exports = function(config)\r\n{\r\n    \r\n    \"use strict\";\r\n    \r\n    var extend = require('extend');\r\n    config = extend ( require('./config.default'), config);\r\n    var cypher = require(\"./cypher\")(config);\r\n    var utils = require(\"./utils\")(config);\r\n    var _ = require(\"lodash\");\r\n\r\n    function Predicate(data){\r\n        _.extend(this,data);\r\n          }\r\n        \r\n    Predicate.prototype.setDirection = function(direction){\r\n        this.direction = direction;\r\n        return this;\r\n    };\r\n    \r\n    Predicate.prototype.toString = function(){\r\n        if (this.direction===\"in\" && !this.symmetrical){\r\n             if (this.reverse){//use reverse if present\r\n                return this.reverse.replace(/_/g, ' ').toLowerCase();\r\n            }\r\n            else{\r\n                var lookup = this.lookup.toUpperCase();\r\n                if (lookup === \"CREATED\" || lookup===\"CREATES\")\r\n                    return \"created by\";\r\n                else if (lookup === \"INFLUENCES\")\r\n                    return \"influenced by\";\r\n                else if (lookup === \"INSPIRES\")\r\n                    return \"inspired by\";\r\n                else if (lookup === \"ANTICIPATES\")\r\n                    return \"anticipated by\";\r\n                else if (lookup === \"DEVELOPS\")\r\n                    return \"developed by\";\r\n                else if (lookup === \"DEPICTS\")\r\n                    return \"depicted by\";\r\n                else if (lookup === \"TYPE_OF\")\r\n                    return \"type(s)\";\r\n                else\r\n                    return \"(\" + this.lookup.replace(/_/g, ' ').toLowerCase() + \")\";\r\n            }\r\n        }\r\n        \r\n       // if (!this.isDirectional || !this.direction || this.direction === \"out\") {\r\n       return this.lookup.replace(/_/g, ' ').toLowerCase();\r\n       \r\n        \r\n    };\r\n    \r\n    Predicate.prototype.flip = function () {\r\n    \r\n        if (!this.isDirectional) {\r\n            return;\r\n        }\r\n        if (this.direction === \"in\") {\r\n            this.setDirection(\"out\");\r\n        }\r\n        else {\r\n            this.setDirection(\"in\");\r\n        }\r\n        return this;\r\n\r\n    };\r\n\r\n\r\n\r\nvar that = {\r\n    init:function(){\r\n        that.refreshList();\r\n        return that;\r\n    }\r\n    ,\r\n    //can pass in active or reverse INFLUENCES OR INFLUENCED_BY\r\n    get: function(lookup){\r\n\r\n        var p = that.list[lookup];\r\n        \r\n        if (!p)\r\n        {\r\n             console.warn('Predicate ' + lookup + ' does not exist in DB');\r\n             \r\n             p = {\r\n                \r\n                lookup: lookup,\r\n                //  force: //Attract or Repel\r\n                //  symmetrical: false,\r\n                reverse: \"(\" + lookup + \")\"\r\n                };\r\n            \r\n        }\r\n\r\n        return new Predicate(p);\r\n    } \r\n\r\n    ,\r\n     //object containing all predicates keyed on Lookup\r\n    list: {}\r\n    ,\r\n    refreshList: function () {//consider creating lookup nodes for relationship types so that i can store properties for them\r\n        \r\n        return cypher.executeQuery(\r\n            \"match (n:Predicate) return ID(n),n\",\r\n                   \"row\")\r\n                   .then(function (data) {\r\n            \r\n            let predicates = {};\r\n            \r\n            for (var i =0; i < data.length; i++) {\r\n                var d = data[i];\r\n                \r\n                let symmetrical = d.row[1].Symmetrical || false;\r\n                 if (d.row[1].Lookup) {\r\n                    predicates[d.row[1].Lookup] = {\r\n                      //  id: d.row[0],\r\n                        lookup: d.row[1].Lookup,\r\n                        force: d.row[1].Force,//Attract or Repel\r\n                        symmetrical:symmetrical,\r\n                        reverse: symmetrical ? d.row[1].Lookup : d.row[1].Reverse \r\n                    };\r\n                }\r\n                else {\r\n                    console.warn(\"Predicate without lookup (id:\" + d.row[0] + \")\");\r\n                }\r\n\r\n            }\r\n\r\n            that.list = predicates;\r\n            return predicates;\r\n\r\n        });\r\n    }\r\n\r\n};\r\n\r\n\r\nreturn that.init();\r\n\r\n};"]}